import{r as o,h as t,F as n,H as i,e}from"./p-1bafedb0.js";import{e as r,p as a,l as s,b as l,f as d,g as c,j as p,k as h,n as u,q as g,r as m,t as f,u as v,v as b,w as y,x as w,y as x,o as L,z as I,A as k,B as P,C as E}from"./p-6bc8d60f.js";import{r as T}from"./p-cc441cb7.js";import{s as R}from"./p-855a8bbd.js";import{s as O,g as C,a as F}from"./p-1445007b.js";import{g as _}from"./p-ba8a3ef0.js";const j=class{constructor(t){o(this,t);this.value=undefined}render(){let o=this.value.replace("<http://www.opengis.net/def/crs/EPSG/0/4326>POINT(","");o=o.replace(")","");const i=o.split(" ");return t(n,null,"long: ",i[0],", lat: ",i[1])}};const S=":host{display:block}.wrapper{display:flex}.literal-container{overflow:clip;width:100%}.literal-container ion-button{display:none;margin-left:auto}.label-container{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.color-light{color:var(--ion-color-step-600, black)}.label{width:100%}.open-modal-btn{min-height:0;padding:0;margin:0 0 0 0.25rem;--padding-inline-start:0;--padding-inline-end:0;--padding-top:0;--padding-bottom:0;--padding-start:0;--padding-end:0}";const X=class{constructor(t){o(this,t);this.handleResize=()=>{this.resizePage()};this.modalTitle=undefined;this.label=undefined;this.language=undefined}componentDidLoad(){this.resizePage();window.addEventListener("resize",this.handleResize)}resizePage(){if(this.labelContainer&&this.itemButton){if(this.labelContainer.scrollWidth>this.labelContainer.clientWidth){this.itemButton.style.display="block"}else{this.itemButton.style.display="none"}}}open(){this.modal.present()}dismiss(){this.modal.dismiss()}render(){return t(n,null,t("div",{class:"wrapper"},t("div",{class:"literal-container"},t("div",{ref:o=>this.labelContainer=o},this.label," ",this.language&&t("span",{class:"color-light"},"@",this.language))),t("ion-button",{class:"open-modal-btn",size:"small",fill:"clear",onClick:()=>this.open(),ref:o=>this.itemButton=o},t("ion-icon",{icon:r}))),t("ion-modal",{ref:o=>this.modal=o,onWillDismiss:()=>this.dismiss(),isOpen:false},t("ion-header",null,t("ion-toolbar",null,t("ion-buttons",{slot:"end"},t("ion-button",{onClick:()=>this.dismiss()},"Close")),t("ion-title",null,this.modalTitle))),t("ion-content",{class:"ion-padding"},this.label)))}};X.style=S;const N=":host{display:inline;vertical-align:middle}ion-icon{--ion-margin:0.3em;margin-right:var(--ion-margin)}";const U={"https://ontome.net/ontology/c21":a,"https://ontome.net/ontology/c363":s,"https://ontome.net/ontology/c68":l,"https://ontome.net/ontology/c523":d,"https://ontome.net/ontology/c50":c,"http://www.w3.org/2006/time#DateTimeDescription":p,"https://ontome.net/ontology/c785":h,"https://ontome.net/ontology/c63":u,"https://ontome.net/ontology/c61":g,"https://ontome.net/ontology/c633":m,"https://ontome.net/ontology/c442":l,"https://ontome.net/ontology/c629":f,"https://ontome.net/ontology/c697":v,"https://ontome.net/ontology/c698":v,"https://ontome.net/ontology/c213":v,"https://ontome.net/ontology/c444":v,"https://ontome.net/ontology/c636":v,"https://ontome.net/ontology/c637":v,"https://ontome.net/ontology/c5":b,"https://ontome.net/ontology/c535":b,"https://ontome.net/ontology/c933":h,"https://ontome.net/ontology/c84":y,"https://ontome.net/ontology/c868":w};const A=x;const M=class{constructor(t){o(this,t);this.classURI=undefined}render(){var o;const n=(o=U[this.classURI])!==null&&o!==void 0?o:A;return t(i,null,n&&t("ion-icon",{icon:n}))}};M.style=N;const $=":host{display:block}";const q=class{constructor(t){o(this,t);this.modalTitle=undefined;this.fetchBeforeRender=true;this.entityUri=undefined;this.sparqlEndpoint=undefined;this.totalCount=undefined;this.pageSize=3;this.language=undefined;this.predicateUri=undefined;this.predicateLabel=undefined;this.uriRegex=undefined;this.uriReplace=undefined;this.modalIsOpen=false}render(){return t(i,null,t("span",{onClick:()=>this.open()},t("slot",null)),t("ion-modal",{ref:o=>this.modal=o},t("ion-header",null,t("ion-toolbar",null,t("ion-buttons",{slot:"start"},t("ion-button",{onClick:()=>this.close()},"Close")),t("ion-title",null,this.modalTitle))),t("ion-content",{ref:o=>this.content=o,class:"ion-padding"},this.modalIsOpen&&t("geov-entity-props-by-predicate",{sparqlEndpoint:this.sparqlEndpoint,entityUri:this.entityUri,totalCount:this.totalCount,language:this.language,predicateUri:this.predicateUri,predicateLabel:this.predicateLabel,fetchBeforeRender:this.fetchBeforeRender}))))}open(){this.modal.present();this.modalIsOpen=true}close(){this.modal.dismiss();this.modalIsOpen=false}};q.style=$;const B='html.ios{--ion-default-font:-apple-system, BlinkMacSystemFont, "Helvetica Neue", "Roboto", sans-serif}html.md{--ion-default-font:"Roboto", "Helvetica Neue", sans-serif}html{--ion-font-family:var(--ion-default-font)}body{background:var(--ion-background-color)}body.backdrop-no-scroll{overflow:hidden}html.ios ion-modal.modal-card ion-header ion-toolbar:first-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:first-of-type,html.ios ion-modal ion-footer ion-toolbar:first-of-type{padding-top:6px}html.ios ion-modal.modal-card ion-header ion-toolbar:last-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:last-of-type{padding-bottom:6px}html.ios ion-modal ion-toolbar{padding-right:calc(var(--ion-safe-area-right) + 8px);padding-left:calc(var(--ion-safe-area-left) + 8px)}@media screen and (min-width: 768px){html.ios ion-modal.modal-card:first-of-type{--backdrop-opacity:0.18}}ion-modal.modal-default.show-modal~ion-modal.modal-default{--backdrop-opacity:0;--box-shadow:none}html.ios ion-modal.modal-card .ion-page{border-top-left-radius:var(--border-radius)}.ion-color-primary{--ion-color-base:var(--ion-color-primary, #3880ff) !important;--ion-color-base-rgb:var(--ion-color-primary-rgb, 56, 128, 255) !important;--ion-color-contrast:var(--ion-color-primary-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-primary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-primary-shade, #3171e0) !important;--ion-color-tint:var(--ion-color-primary-tint, #4c8dff) !important}.ion-color-secondary{--ion-color-base:var(--ion-color-secondary, #3dc2ff) !important;--ion-color-base-rgb:var(--ion-color-secondary-rgb, 61, 194, 255) !important;--ion-color-contrast:var(--ion-color-secondary-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-secondary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-secondary-shade, #36abe0) !important;--ion-color-tint:var(--ion-color-secondary-tint, #50c8ff) !important}.ion-color-tertiary{--ion-color-base:var(--ion-color-tertiary, #5260ff) !important;--ion-color-base-rgb:var(--ion-color-tertiary-rgb, 82, 96, 255) !important;--ion-color-contrast:var(--ion-color-tertiary-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-tertiary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-tertiary-shade, #4854e0) !important;--ion-color-tint:var(--ion-color-tertiary-tint, #6370ff) !important}.ion-color-success{--ion-color-base:var(--ion-color-success, #2dd36f) !important;--ion-color-base-rgb:var(--ion-color-success-rgb, 45, 211, 111) !important;--ion-color-contrast:var(--ion-color-success-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-success-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-success-shade, #28ba62) !important;--ion-color-tint:var(--ion-color-success-tint, #42d77d) !important}.ion-color-warning{--ion-color-base:var(--ion-color-warning, #ffc409) !important;--ion-color-base-rgb:var(--ion-color-warning-rgb, 255, 196, 9) !important;--ion-color-contrast:var(--ion-color-warning-contrast, #000) !important;--ion-color-contrast-rgb:var(--ion-color-warning-contrast-rgb, 0, 0, 0) !important;--ion-color-shade:var(--ion-color-warning-shade, #e0ac08) !important;--ion-color-tint:var(--ion-color-warning-tint, #ffca22) !important}.ion-color-danger{--ion-color-base:var(--ion-color-danger, #eb445a) !important;--ion-color-base-rgb:var(--ion-color-danger-rgb, 235, 68, 90) !important;--ion-color-contrast:var(--ion-color-danger-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-danger-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-danger-shade, #cf3c4f) !important;--ion-color-tint:var(--ion-color-danger-tint, #ed576b) !important}.ion-color-light{--ion-color-base:var(--ion-color-light, #f4f5f8) !important;--ion-color-base-rgb:var(--ion-color-light-rgb, 244, 245, 248) !important;--ion-color-contrast:var(--ion-color-light-contrast, #000) !important;--ion-color-contrast-rgb:var(--ion-color-light-contrast-rgb, 0, 0, 0) !important;--ion-color-shade:var(--ion-color-light-shade, #d7d8da) !important;--ion-color-tint:var(--ion-color-light-tint, #f5f6f9) !important}.ion-color-medium{--ion-color-base:var(--ion-color-medium, #92949c) !important;--ion-color-base-rgb:var(--ion-color-medium-rgb, 146, 148, 156) !important;--ion-color-contrast:var(--ion-color-medium-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-medium-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-medium-shade, #808289) !important;--ion-color-tint:var(--ion-color-medium-tint, #9d9fa6) !important}.ion-color-dark{--ion-color-base:var(--ion-color-dark, #222428) !important;--ion-color-base-rgb:var(--ion-color-dark-rgb, 34, 36, 40) !important;--ion-color-contrast:var(--ion-color-dark-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-dark-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-dark-shade, #1e2023) !important;--ion-color-tint:var(--ion-color-dark-tint, #383a3e) !important}.ion-page{left:0;right:0;top:0;bottom:0;display:flex;position:absolute;flex-direction:column;justify-content:space-between;contain:layout size style;overflow:hidden;z-index:0}ion-modal>.ion-page{position:relative;contain:layout style;height:100%}.split-pane-visible>.ion-page.split-pane-main{position:relative}ion-route,ion-route-redirect,ion-router,ion-select-option,ion-nav-controller,ion-menu-controller,ion-action-sheet-controller,ion-alert-controller,ion-loading-controller,ion-modal-controller,ion-picker-controller,ion-popover-controller,ion-toast-controller,.ion-page-hidden{display:none !important}.ion-page-invisible{opacity:0}.can-go-back>ion-header ion-back-button{display:block}html.plt-ios.plt-hybrid,html.plt-ios.plt-pwa{--ion-statusbar-padding:20px}@supports (padding-top: 20px){html{--ion-safe-area-top:var(--ion-statusbar-padding)}}@supports (padding-top: constant(safe-area-inset-top)){html{--ion-safe-area-top:constant(safe-area-inset-top);--ion-safe-area-bottom:constant(safe-area-inset-bottom);--ion-safe-area-left:constant(safe-area-inset-left);--ion-safe-area-right:constant(safe-area-inset-right)}}@supports (padding-top: env(safe-area-inset-top)){html{--ion-safe-area-top:env(safe-area-inset-top);--ion-safe-area-bottom:env(safe-area-inset-bottom);--ion-safe-area-left:env(safe-area-inset-left);--ion-safe-area-right:env(safe-area-inset-right)}}ion-card.ion-color .ion-inherit-color,ion-card-header.ion-color .ion-inherit-color{color:inherit}.menu-content{transform:translate3d(0,  0,  0)}.menu-content-open{cursor:pointer;touch-action:manipulation;pointer-events:none}.ios .menu-content-reveal{box-shadow:-8px 0 42px rgba(0, 0, 0, 0.08)}[dir=rtl].ios .menu-content-reveal{box-shadow:8px 0 42px rgba(0, 0, 0, 0.08)}.md .menu-content-reveal{box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18)}.md .menu-content-push{box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18)}ion-accordion-group.accordion-group-expand-inset>ion-accordion:first-of-type{border-top-left-radius:8px;border-top-right-radius:8px}ion-accordion-group.accordion-group-expand-inset>ion-accordion:last-of-type{border-bottom-left-radius:8px;border-bottom-right-radius:8px}ion-accordion-group>ion-accordion:last-of-type ion-item[slot=header]{--border-width:0px}ion-accordion.accordion-animated>[slot=header] .ion-accordion-toggle-icon{transition:300ms transform cubic-bezier(0.25, 0.8, 0.5, 1)}@media (prefers-reduced-motion: reduce){ion-accordion .ion-accordion-toggle-icon{transition:none !important}}ion-accordion.accordion-expanding>[slot=header] .ion-accordion-toggle-icon,ion-accordion.accordion-expanded>[slot=header] .ion-accordion-toggle-icon{transform:rotate(180deg)}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-previous ion-item[slot=header]{--border-width:0px;--inner-border-width:0px}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanding:first-of-type,ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanded:first-of-type{margin-top:0}ion-input input::-webkit-date-and-time-value{text-align:start}.ion-datetime-button-overlay{--width:fit-content;--height:fit-content}.ion-datetime-button-overlay ion-datetime.datetime-grid{width:320px;min-height:320px}:host{display:block}ion-list{--ion-item-background:none}ion-item.heading{--padding-start:0;--inner-padding-end:0;--ion-item-background:none}geov-paginator{margin-left:auto}a.propertyLabel,a.propertyLabel:visited{text-decoration:var(--gv-property-link-decoration, none)}a.propertyLabel:hover{color:var(--ion-color-primary-shade, #5e3eaa);text-decoration:underline}a.propertyLabel{color:var(--gv-property-link-color, black);font-size:1.5rem}';const W=(o,t,n,i,e)=>`\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n\nSELECT DISTINCT ?entity ?entityLabel ?entityType ?entityTypeLabel ?dt\nWHERE {\n  <${t}> <${o}> ?entity .\n  OPTIONAL {?entity rdfs:label ?entityLabel . FILTER(LANG(?entityLabel) IN ("${e}", "en")) .}\n  OPTIONAL {?entity rdf:type ?entityType . OPTIONAL {?entityType rdfs:label ?entityTypeLabel . FILTER(LANG(?entityTypeLabel) IN ("${e}", "en")) .}}\n  BIND (datatype(?entity) AS ?dt) .\n}\nLIMIT ${n} OFFSET ${i}\n`;const z=class{constructor(t){o(this,t);this.pageChanged=e(this,"pageChanged",7);this._ssrId=undefined;this.data=undefined;this.fetchBeforeRender=true;this.entityUri=undefined;this.sparqlEndpoint=undefined;this.totalCount=undefined;this.pageSize=3;this.language=undefined;this.predicateUri=undefined;this.predicateLabel=undefined;this.uriRegex=undefined;this.uriReplace=undefined;this.color="";this.pageIndex=0;this.entities=undefined;O(this)}async componentWillLoad(){if(this.fetchBeforeRender){this.data=C(this._ssrId)}if(!this.data){this.data={loading:true};await this.pageReload().then((o=>{this.data=o;F(this._ssrId,o);return o})).catch((o=>{this.data=o;return o}))}}changePage(o){this.pageIndex=o.detail.pageIndex;this.data={loading:true};this.pageReload().then((o=>{this.data=o;F(this._ssrId,o);return o})).catch((o=>{this.data=o;return o}))}async pageReload(){const o=W(this.predicateUri,this.entityUri,this.pageSize,this.pageIndex*this.pageSize,this.language);return R(this.sparqlEndpoint,o).then((o=>{var t;return{entities:(t=o===null||o===void 0?void 0:o.results)===null||t===void 0?void 0:t.bindings,loading:false}})).catch((o=>({error:true,loading:false})))}render(){var o,n;const e=this.totalCount>this.pageSize;return t(i,null,t("ion-grid",{fixed:true},t("ion-item",{class:"heading",color:this.color,lines:"full"},t("a",{class:"propertyLabel",href:this.predicateUri},this.predicateLabel),e&&this.renderPaginator()),t("ion-list",{lines:"full"},(n=(o=this.data)===null||o===void 0?void 0:o.entities)===null||n===void 0?void 0:n.map((o=>this.renderItem(o))))))}renderItem(o){const n=o.entity.type==="uri";if(n){return this.renderUri(o)}return t("ion-item",null,t("ion-label",null,this.renderLiteral(o)))}renderUri(o){var t;const n=(t=o.entityType)===null||t===void 0?void 0:t.value;switch(n){case undefined:return this.renderExternalUri(o);default:return this.renderGenericEntity(o)}}renderExternalUri(o){var n,i,e;const r=this.uriRegex;const a=this.uriReplace;const s=T(o.entity.value,r,a);const l=s.includes("geovistory.org");const d=l?"":"_blank";const c=l?undefined:L;return t("ion-item",{color:this.color,href:s,target:d,detailIcon:c},((n=o.entityLabel)===null||n===void 0?void 0:n.value)?t("p",null,(i=o.entityLabel)===null||i===void 0?void 0:i.value):t("p",null,(e=o.entity)===null||e===void 0?void 0:e.value))}renderGenericEntity(o){return t("ion-item",null,t("geov-list-item-nested-properties",{sparqlEndpoint:this.sparqlEndpoint,entityUri:o.entity.value,language:"en",fetchBeforeRender:this.fetchBeforeRender,parent:{subjectUri:this.entityUri,predicateUri:this.predicateUri},uriRegex:this.uriRegex,uriReplace:this.uriReplace}))}renderPaginator(){return t("geov-paginator",{color:this.color,length:this.totalCount,pageSize:this.pageSize,pageIndex:this.pageIndex,onPageChanged:o=>this.changePage(o),showFirstLastButtons:false})}renderLiteral(o){var n,i,e,r;switch((n=o.dt)===null||n===void 0?void 0:n.value){case"http://www.opengis.net/ont/geosparql#wktLiteral":return t("geov-display-geosparql-wktliteral",{color:this.color,value:(i=o.entity)===null||i===void 0?void 0:i.value});case"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":case"http://www.w3.org/2001/XMLSchema#string":default:return t("geov-display-string-literal",{color:this.color,modalTitle:this.predicateLabel,label:(e=o.entity)===null||e===void 0?void 0:e.value,language:(r=o.entity)===null||r===void 0?void 0:r["xml:lang"]})}}};z.style=B;const D=":host {\n  display: block;\n  width: 100%;\n}\n\ngeov-display-string-literal {\n  --border-top: none;\n  --padding-start: 0;\n  --min-height: 0;\n  --inner-padding-end: 0;\n}\n\ngeov-time-span {\n  display: inline;\n  padding-left: 1rem;\n  color: var(--ion-color-step-600);\n}\n\nion-item {\n  --padding-start: 0;\n}\n\n.containerForQuery {\n  container-type: inline-size;\n}\n\n.container {\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.header {\n  padding: 1rem 16px 0.5rem 0;\n  flex-basis: 200px;\n  flex-grow: 1;\n  flex-shrink: 0;\n  border-bottom: dashed 1px var(--border-color);\n  border-right: dashed 1px var(--ion-color-tertiary);\n}\n\n.content ion-col {\n  flex-basis: 300px;\n}\n\n.content {\n  padding: 0.5rem 0 0.5rem 16px;\n  flex-basis: 300px;\n  flex-grow: 1;\n  flex-shrink: 0;\n}\n\n.header .classLabelContainer {\n  color: var(--gv-class-link-color, #000);\n}\n\n.header a.classLabel {\n  color: var(--gv-class-link-color, #000);\n  text-decoration: var(--gv-class-link-decoration);\n}\n\n.header a.classLabel:hover {\n  text-decoration: underline;\n}\n\n.nestedProp .propLabelWrapper a.propLabel {\n  color: var(--gv-property-link-color, #000);\n  text-decoration: var(--gv-property-link-decoration);\n}\n\n.nestedProp .propLabelWrapper a.propLabel:hover {\n  text-decoration: underline;\n}\n\nion-col {\n  padding: 0;\n  margin: 0;\n}\n\na.entityLink {\n  color: var(--gv-entity-link-color, #000);\n  text-decoration: var(--gv-entity-link-decoration);\n}\n\na.entityLink:hover {\n  text-decoration: underline;\n}\n\n.timespanLabel geov-time-span {\n  padding: 0;\n}\n\n.pointer {\n  cursor: pointer;\n}\n\n@container (width > 532px) {\n  .container {\n    flex-wrap: nowrap;\n  }\n\n  .header {\n    flex-grow: 0;\n    border-right: dashed 1px var(--border-color);\n    border-bottom: none;\n  }\n\n  .content ion-col {\n    flex-basis: 0px;\n  }\n}\n";const G=(o,t)=>` PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n    PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n    PREFIX owl: <http://www.w3.org/2002/07/owl#>\n    PREFIX xml: <http://www.w3.org/XML/1998/namespace>\n    PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>\n    PREFIX geo: <http://www.opengis.net/ont/geosparql#>\n    PREFIX time: <http://www.w3.org/2006/time#>\n    PREFIX ontome: <https://ontome.net/ontology/>\n    PREFIX geov: <http://geovistory.org/resource/>\n\n    SELECT\n      ?predicate # predicate uri\n      ?count # count of props per predicate\n      ?object # one sample object per predicate\n      (GROUP_CONCAT(DISTINCT ?pLabel; separator=", ") as ?predicateLabel) # predicate label\n      (GROUP_CONCAT(DISTINCT ?oLabel; separator=", ") as ?objectLabel) # object label\n    WHERE {\n\n      # Innermost subquery:\n      {\n        # Select all properties of entity, group by predicate, count\n        # and select one sample object per predicate\n        SELECT ?predicate (count(?predicate) as ?count) (sample(?o) as ?object) WHERE {\n          <${o}> ?predicate ?o.\n        }\n        GROUP BY ?predicate\n      }.\n\n      # Left join predicate labels\n      OPTIONAL {\n        ?predicate rdfs:label ?pLabel . FILTER(LANG(?pLabel) IN ("${t}", "en")) .\n      }.\n\n      # Left join add object labels\n      OPTIONAL {\n        ?object rdfs:label ?oLabel\n      }.\n  }\n\n  GROUP BY ?predicate ?count ?object\n  # limit to max 50 predicate groups\n  LIMIT 50`;const H=class{constructor(t){o(this,t);this._ssrId=undefined;this.data=undefined;this.fetchBeforeRender=true;this.sparqlEndpoint=undefined;this.entityUri=undefined;this.language="en";this.predicateInclude=undefined;this.predicateExclude=undefined;this.uriRegex=undefined;this.uriReplace=undefined;this.color="";this.parent=undefined;O(this)}async componentWillLoad(){if(this.fetchBeforeRender){this.data=C(this._ssrId)}if(!this.data){this.data={loading:true};await this.fetchData().then((o=>{var t;o.nestedProps=(t=o.nestedProps)!==null&&t!==void 0?t:[];this.data=o;F(this._ssrId,o);return o})).catch((o=>{this.data=o;return o}))}}render(){var o,n;const{rdfTypeProp:e,rdfsLabelProp:r,restProps:a}=this.splitProps(this.data.nestedProps);return t(i,null,t("div",{class:"containerForQuery"},t("div",{class:"container"},t("div",{class:"header"},t("div",{class:"classLabelContainer"},t("geov-entity-class-icon",{classURI:e.object.value}),t("a",{href:e.object.value,target:"_blank",class:"classLabel"},(o=e===null||e===void 0?void 0:e.objectLabel)===null||o===void 0?void 0:o.value)," ",t("div",{class:"timespanLabel"},t("geov-time-span",{sparqlEndpoint:this.sparqlEndpoint,entityUri:_(this.entityUri)}))),t("div",{class:"entityLabelContainer"},t("a",{href:this.prepareUrl(this.entityUri),target:"_blank",class:"entityLink"},(n=r===null||r===void 0?void 0:r.object)===null||n===void 0?void 0:n.value))),t("div",{class:"content"},t("ion-row",null,a.map((o=>{var n;return t("ion-col",null,t("ion-item",{lines:"none",class:"nestedProp"},t("ion-label",null,t("p",{class:"propLabelWrapper"},this.renderPredicateLabel(o.predicateLabel,o.predicate)),this.countBiggerThanOne(o.count)?t("p",null,this.renderModal(o,(n=e===null||e===void 0?void 0:e.objectLabel)===null||n===void 0?void 0:n.value)):t("h3",null,this.renderObject(o.object,o.objectLabel,this.getPredicateLabel(o.predicateLabel,o.predicate))))))})))))),t("slot",null))}splitProps(o){let t;let n;const i=[];for(const e of o){if(e.predicate.value==="http://www.w3.org/1999/02/22-rdf-syntax-ns#type")n=e;else if(e.predicate.value==="http://www.w3.org/2000/01/rdf-schema#label")t=e;else if(!this.isInverseOfParent(e))i.push(e)}i.sort(((o,t)=>{var n,i,e,r;const a=(i=(n=o===null||o===void 0?void 0:o.predicateLabel)===null||n===void 0?void 0:n.value)!==null&&i!==void 0?i:"";const s=(r=(e=t===null||t===void 0?void 0:t.predicateLabel)===null||e===void 0?void 0:e.value)!==null&&r!==void 0?r:"";return a.localeCompare(s)}));return{rdfTypeProp:n,rdfsLabelProp:t,restProps:i}}isInverseOfParent(o){var t,n,i;if(!((t=this.parent)===null||t===void 0?void 0:t.predicateUri)||!((n=this.parent)===null||n===void 0?void 0:n.subjectUri))return false;if(parseInt((i=o.count)===null||i===void 0?void 0:i.value)>1)return false;const e=o.predicate.value;const r=this.parent.predicateUri;const a=()=>{const o=e.replace(r,"");const t=r.replace(e,"");return o==="i"||t=="i"};if(o.object.value===this.parent.subjectUri&&a())return true;return false}async fetchData(){let o={loading:true};const t=G(this.entityUri,this.language);await R(this.sparqlEndpoint,t).then((t=>{var n;o={loading:false,nestedProps:(n=t===null||t===void 0?void 0:t.results)===null||n===void 0?void 0:n.bindings}})).catch((t=>{o={loading:false,error:true}}));return o}renderPredicateLabel(o,n){return t("a",{class:"propLabel",href:n.value,target:"_blank"},this.getPredicateLabel(o,n))}getPredicateLabel(o,t){var n;return(n=o===null||o===void 0?void 0:o.value)!==null&&n!==void 0?n:t.value.replace("http://www.w3.org/2000/01/rdf-schema#","rdfs:").replace("http://www.w3.org/1999/02/22-rdf-syntax-ns#","rdf:")}renderModal(o,n){var i,e;return t("geov-entity-predicate-modal",{modalTitle:n,sparqlEndpoint:this.sparqlEndpoint,entityUri:this.entityUri,totalCount:parseInt((i=o.count)===null||i===void 0?void 0:i.value),language:this.language,predicateUri:o.predicate.value,predicateLabel:o.predicateLabel.value,fetchBeforeRender:false},t("span",{class:"pointer"}," ",(e=o.count)===null||e===void 0?void 0:e.value," items..."))}countBiggerThanOne(o){const t=parseInt(o===null||o===void 0?void 0:o.value);return t>1}renderObject(o,n,i){var e;if((o===null||o===void 0?void 0:o.type)==="uri"){return t("a",{href:this.prepareUrl(o===null||o===void 0?void 0:o.value),target:"_blank",class:"entityLink"},(e=n===null||n===void 0?void 0:n.value)!==null&&e!==void 0?e:o===null||o===void 0?void 0:o.value)}switch(o===null||o===void 0?void 0:o.datatype){case"http://www.opengis.net/ont/geosparql#wktLiteral":return t("geov-display-geosparql-wktliteral",{color:this.color,value:o===null||o===void 0?void 0:o.value});case"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":case"http://www.w3.org/2001/XMLSchema#string":default:return t("geov-display-string-literal",{color:this.color,modalTitle:i,label:o===null||o===void 0?void 0:o.value,language:o===null||o===void 0?void 0:o["xml:lang"]})}}prepareUrl(o){return T(o,this.uriRegex,this.uriReplace)}};H.style=D;const Y=":host{display:flex;align-items:center;flex-direction:row;flex-wrap:wrap}ion-item{--inner-padding-end:var(--inner-padding-end)}";const Q=class{constructor(t){o(this,t);this.pageChanged=e(this,"pageChanged",7);this.hidePageSize=undefined;this.length=0;this.pageIndex=0;this.pageSize=25;this.showFirstLastButtons=true;this.color=undefined}render(){const o=Math.floor((this.length-1)/this.pageSize)+1;const n=this.pageIndex<=0;const e=this.pageIndex+1>=o;const r=this.pageIndex*this.pageSize+1;const a=this.pageIndex*this.pageSize+this.pageSize;return t(i,null,t("ion-item",{color:this.color,lines:"none"},!this.hidePageSize&&t("ion-note",null,r," – ",a<=this.length?a:this.length," of ",this.length),t("ion-buttons",null,this.showFirstLastButtons&&t("ion-button",{disabled:n,onClick:()=>this.changePageTo(0)},t("ion-icon",{slot:"icon-only",icon:I})),t("ion-button",{disabled:n,onClick:()=>this.changePageTo(this.pageIndex-1)},t("ion-icon",{slot:"icon-only",icon:k})),t("ion-button",{disabled:e,onClick:()=>this.changePageTo(this.pageIndex+1)},t("ion-icon",{slot:"icon-only",icon:P})),this.showFirstLastButtons&&t("ion-button",{disabled:e,onClick:()=>this.changePageTo(o-1)},t("ion-icon",{slot:"icon-only",icon:E})))))}changePageTo(o){const t=this.pageIndex;this.pageIndex=o;this.pageChanged.emit({length:this.length,pageIndex:this.pageIndex,pageSize:this.pageSize,previousPageIndex:t})}};Q.style=Y;const J=":host{display:block}";const K=o=>`\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n    PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n    PREFIX owl: <http://www.w3.org/2002/07/owl#>\n    PREFIX xml: <http://www.w3.org/XML/1998/namespace>\n    PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>\n    PREFIX geo: <http://www.opengis.net/ont/geosparql#>\n    PREFIX time: <http://www.w3.org/2006/time#>\n    PREFIX ontome: <https://ontome.net/ontology/>\n    PREFIX geov: <http://geovistory.org/resource/>\n\n    SELECT\n      ?predicate # predicate uri\n      (SAMPLE(?y) as ?year)\n      (SAMPLE(?m) as ?month)\n      (SAMPLE(?d) as ?day)\n      (SAMPLE(?tUnit) as ?timeUnit)\n\n    WHERE {\n\n      # Innermost subquery:\n      {\n        # Select all properties of entity, group by predicate\n        # and select one sample object per predicate\n        SELECT ?predicate (sample(?o) as ?object) WHERE {\n          <${o}> ?predicate ?o.\n        }\n        GROUP BY ?predicate\n      }.\n\n  \t  # Left year, month, day\n      OPTIONAL { ?object time:year ?y }.\n      OPTIONAL { ?object time:month ?m }.\n      OPTIONAL { ?object time:day ?d }.\n      OPTIONAL { ?object time:unitType ?tUnit }.\n  }\n\n  GROUP BY ?predicate ?object\n  # limit to max 50 predicate groups\n  LIMIT 50`;const V=class{constructor(t){o(this,t);this._ssrId=undefined;this.data=undefined;this.fetchBeforeRender=true;this.sparqlEndpoint=undefined;this.entityUri=undefined;O(this)}async componentWillLoad(){if(this.fetchBeforeRender){this.data=C(this._ssrId)}if(!this.data){this.data={loading:true};await this.fetchData().then((o=>{this.data=o;F(this._ssrId,o);return o})).catch((o=>{this.data=o;return o}))}}async fetchData(){let o={loading:true};const t=K(this.entityUri);await R(this.sparqlEndpoint,t).then((t=>{var n;o={loading:false,rows:(n=t===null||t===void 0?void 0:t.results)===null||n===void 0?void 0:n.bindings}})).catch((t=>{o={loading:false,error:true}}));return o}rowsToString(o){const t=o.map((o=>this.getTime(o))).filter((o=>!!o.timeUnit)).sort(((o,t)=>{if(o.year!==t.year){return o.year-t.year}if(o.month!==t.month){return o.month-t.month}return o.day-t.day}));if(t.length===0)return;const n=t[0];const i=t[t.length-1];if(n===i)return this.timeInfoToString(n);return`${this.timeInfoToString(n)} – ${this.timeInfoToString(i)}`}getTime(o){var t,n,i,e,r,a;return{year:parseInt((t=o.year)===null||t===void 0?void 0:t.value),month:parseInt((i=(n=o.month)===null||n===void 0?void 0:n.value)===null||i===void 0?void 0:i.replace("--","")),day:parseInt((r=(e=o.day)===null||e===void 0?void 0:e.value)===null||r===void 0?void 0:r.replace("---","")),timeUnit:(a=o.timeUnit)===null||a===void 0?void 0:a.value}}timeInfoToString(o){switch(o.timeUnit){case"http://www.w3.org/2006/time#unitYear":return`${o.year}`;case"http://www.w3.org/2006/time#unitMonth":return`${o.year}-${o.month.toString().padStart(2,"0")}`;case"http://www.w3.org/2006/time#unitDay":default:return`${o.year}-${o.month.toString().padStart(2,"0")}-${o.day.toString().padStart(2,"0")}`}}render(){return t(n,null,this.rowsToString(this.data.rows))}};V.style=J;export{j as geov_display_geosparql_wktliteral,X as geov_display_string_literal,M as geov_entity_class_icon,q as geov_entity_predicate_modal,z as geov_entity_props_by_predicate,H as geov_list_item_nested_properties,Q as geov_paginator,V as geov_time_span};
//# sourceMappingURL=p-fd98e700.entry.js.map