import{r as i,h as t,H as s,d as e}from"./p-1bafedb0.js";import{i as o}from"./p-27a92608.js";import{m as a,s as n,a as r}from"./p-6bc8d60f.js";const l=async()=>new Promise(((i,t)=>{if(o())return i(null);if("Yasgui"in window){return i(window["Yasgui"])}const s=document.createElement("script");s.onload=()=>i(window["Yasgui"]);s.onerror=t;s.src="https://cdn.jsdelivr.net/npm/@triply/yasgui@4.2.28/build/yasgui.min.js";document.body.appendChild(s);const e=document.createElement("link");e.href="https://cdn.jsdelivr.net/npm/@triply/yasgui@4.2.28/build/yasgui.min.css";e.rel="stylesheet";e.type="text/css";document.body.appendChild(e)}));function u(i){return class t{constructor(i){this.priority=10;this.hideFromSelection=false;this.label="Map Circles";this.expectedKeys=[{name:"radius",required:false,customValidator:i=>{if(Number(i===null||i===void 0?void 0:i.value)>0)return;return new Set(["must be parsable to a number, and bigger than 0"])}},{name:"number",required:false,customValidator:i=>{if(!isNaN(Number(i===null||i===void 0?void 0:i.value)))return;return new Set(["must be parsable to a number"])}},{name:"long",required:true,customValidator:i=>{const t=Number(i===null||i===void 0?void 0:i.value);if(t>=-180&&t<=180)return;return new Set(["must be parsable to a number in the range -180 and +180"])}},{name:"lat",required:true,customValidator:i=>{const t=Number(i===null||i===void 0?void 0:i.value);if(t>=-90&&t<=90)return;return new Set(["must be parsable to a number in the range -90 and +90"])}}];this.yasr=i}draw(){const t=document.createElement("geov-yasgui-data-validation");const s=this.yasr.results.getBindings();t.data=s;t.expectedKeys=this.expectedKeys;this.yasr.resultsEl.appendChild(t);this.yasr.resultsEl.classList.add("ion-padding");t.addEventListener("validationCompleted",(e=>{var o;if(e.detail){const e=document.createElement("geov-yasgui-map-circles");e.data=s;e.style.height=(o=i===null||i===void 0?void 0:i.mapHeight)!==null&&o!==void 0?o:"400px";for(const t in i){e[t]=i[t]}this.yasr.resultsEl.classList.remove("ion-padding");this.yasr.resultsEl.removeChild(t);this.yasr.resultsEl.appendChild(e)}}))}canHandleResults(){return!this.yasr.results.hasError()}getIcon(){const i=document.createElement("ion-icon");i.icon=a;return i}}}const g="geov-yasgui{position:relative;display:block;width:100%;height:100%}geov-yasgui .toggle-button{position:absolute;z-index:1000;right:var(--ion-padding, 1rem);top:var(--ion-padding, 1rem)}geov-yasgui.toggling .tabsList,geov-yasgui.toggling .yasr_header,geov-yasgui.toggling .yasqe .resizeWrapper,geov-yasgui.toggling .yasqe .CodeMirror,geov-yasgui.toggling .controlbar{transition:all .2s ease-in;overflow:hidden}geov-yasgui .tabsList.collapsed,geov-yasgui .yasr_header.collapsed,geov-yasgui .yasqe.collapsed .resizeWrapper,geov-yasgui .controlbar.collapsed,geov-yasgui .yasqe.collapsed .CodeMirror{transition:all .2s ease-out;overflow:hidden}geov-yasgui .tabsList.collapsed,geov-yasgui .yasr_header.collapsed,geov-yasgui .yasqe.collapsed .resizeWrapper{height:0px}geov-yasgui .controlbar.collapsed{max-height:0px}geov-yasgui .yasqe.collapsed .CodeMirror{height:0px !important;border:none;min-height:0px}geov-yasgui .yasr.collapsed{margin-top:0px}";const d=class{constructor(t){i(this,t);this.toggling=false;this.plugins=new Set;this.collapse=false;this.defaultPlugin="table";this.pluginOrder=["table","response"];this.pluginConfig={};this.queryTabs=[];this.hideYasqueToggle=false}async componentWillLoad(){this.Y=await l()}componentDidLoad(){if(!o()){this.setupYasr();localStorage.removeItem("yagui__config");if(!this.el)return;const i=new this.Y(this.el,{});if(this.queryTabs.length)i.getTab().close();const t=this.Y.Tab.getDefaults();this.queryTabs.forEach(((s,e)=>{var o;i.addTab(e===0,Object.assign(Object.assign({},t),{id:"tab"+e,requestConfig:Object.assign(Object.assign({},t.requestConfig),{endpoint:s.sparqlEndpoint}),name:s.name,yasqe:{value:s.query},yasr:Object.assign(Object.assign({},t.yasr),{settings:{selectedPlugin:(o=s.selectedPlugin)!==null&&o!==void 0?o:this.defaultPlugin}})}),{avoidDuplicateTabs:true})}));i.getTab().query();this.setYasqueVisibility()}}toggleVisiblity(){if(this.toggling)return;this.collapse=!this.collapse;this.setYasqueVisibility()}async setYasqueVisibility(){this.toggling=true;this.el.classList.add("toggling");const i=this.el.querySelectorAll(".yasr, .yasr_header, .yasqe, .tabsList, .controlbar");i.forEach((i=>{this.collapse?i.classList.add("collapsed"):i.classList.remove("collapsed")}));await new Promise((i=>setTimeout(i,200)));this.el.classList.remove("toggling");this.toggling=false}setupYasr(){this.registerCustomPlugins();this.setPluginOrder()}registerCustomPlugins(){var i;const t={mapCircles:u(this.pluginConfig.mapCircles)};(i=this.plugins)===null||i===void 0?void 0:i.forEach((i=>{if(!!t[i])this.Y.Yasr.registerPlugin(i,t[i])}))}setPluginOrder(){this.Y.Yasr.defaults.pluginOrder=this.pluginOrder}render(){return t(s,null,!this.hideYasqueToggle&&t("ion-button",{class:"toggle-button",size:"small",onClick:()=>this.toggleVisiblity(),title:this.collapse?"Show query":"Hide query"},this.collapse?t("ion-icon",{slot:"icon-only",icon:n}):t("ion-icon",{slot:"icon-only",icon:r})))}get el(){return e(this)}};d.style=g;export{d as geov_yasgui};
//# sourceMappingURL=p-61d28730.entry.js.map