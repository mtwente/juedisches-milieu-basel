import{r as k,e as v,h as a,H as x,d as I}from"./p-1bafedb0.js";import{r as y,g}from"./p-a533da20.js";import{a as E,b as L,c as S}from"./p-d196efc2.js";import{a as A,g as P}from"./p-501d07b5.js";import{c as N}from"./p-b2d007f6.js";import"./p-eb6f4547.js";import"./p-c76826f0.js";const V=":host{-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px;padding-top:0px;padding-bottom:0px;height:200px;outline:none;font-size:22px;scroll-snap-type:y mandatory;overflow-x:hidden;overflow-y:scroll;scrollbar-width:none;text-align:center}:host::-webkit-scrollbar{display:none}:host .picker-item{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:100%;height:34px;border:0px;outline:none;background:transparent;color:inherit;font-family:var(--ion-font-family, inherit);font-size:inherit;line-height:34px;text-align:inherit;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;overflow:hidden;scroll-snap-align:center}:host .picker-item-empty,:host .picker-item.picker-item-disabled{scroll-snap-align:none;cursor:default}:host .picker-item.picker-item-disabled{opacity:0.4}:host(.picker-column-active) .picker-item.picker-item-active{color:var(--ion-color-base)}@media (any-hover: hover){:host(:focus){outline:none;background:rgba(var(--ion-color-base-rgb), 0.2)}}",O=":host{-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px;padding-top:0px;padding-bottom:0px;height:200px;outline:none;font-size:22px;scroll-snap-type:y mandatory;overflow-x:hidden;overflow-y:scroll;scrollbar-width:none;text-align:center}:host::-webkit-scrollbar{display:none}:host .picker-item{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:100%;height:34px;border:0px;outline:none;background:transparent;color:inherit;font-family:var(--ion-font-family, inherit);font-size:inherit;line-height:34px;text-align:inherit;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;overflow:hidden;scroll-snap-align:center}:host .picker-item-empty,:host .picker-item.picker-item-disabled{scroll-snap-align:none;cursor:default}:host .picker-item.picker-item-disabled{opacity:0.4}:host(.picker-column-active) .picker-item.picker-item-active{color:var(--ion-color-base)}@media (any-hover: hover){:host(:focus){outline:none;background:rgba(var(--ion-color-base-rgb), 0.2)}}:host .picker-item-active{color:var(--ion-color-base)}",C=class{constructor(s){k(this,s),this.ionChange=v(this,"ionChange",7),this.isScrolling=!1,this.isColumnVisible=!1,this.canExitInputMode=!0,this.centerPickerItemInView=(t,e=!0,i=!0)=>{const{el:r,isColumnVisible:o}=this;if(o){const n=t.offsetTop-3*t.clientHeight+t.clientHeight/2;r.scrollTop!==n&&(this.canExitInputMode=i,r.scroll({top:n,left:0,behavior:e?"smooth":void 0}))}},this.setPickerItemActiveState=(t,e)=>{e?(t.classList.add(f),t.part.add(b)):(t.classList.remove(f),t.part.remove(b))},this.inputModeChange=t=>{if(!this.numericInput)return;const{useInputMode:e,inputModeColumn:i}=t.detail,r=i===void 0||i===this.el;if(!e||!r){this.setInputModeActive(!1);return}this.setInputModeActive(!0)},this.setInputModeActive=t=>{if(this.isScrolling){this.scrollEndCallback=()=>{this.isActive=t};return}this.isActive=t},this.initializeScrollListener=()=>{const t=A("ios"),{el:e}=this;let i,r=this.activeItem;const o=()=>{y(()=>{i&&(clearTimeout(i),i=void 0),this.isScrolling||(t&&E(),this.isScrolling=!0);const n=e.getBoundingClientRect(),l=n.x+n.width/2,h=n.y+n.height/2,c=e.shadowRoot.elementFromPoint(l,h);r!==null&&this.setPickerItemActiveState(r,!1),!(c===null||c.disabled)&&(c!==r&&(t&&L(),this.canExitInputMode&&this.exitInputMode()),r=c,this.setPickerItemActiveState(c,!0),i=setTimeout(()=>{this.isScrolling=!1,t&&S();const{scrollEndCallback:u}=this;u&&(u(),this.scrollEndCallback=void 0),this.canExitInputMode=!0;const d=c.getAttribute("data-index");if(d===null)return;const m=parseInt(d,10),p=this.items[m];p.value!==this.value&&this.setValue(p.value)},250))})};y(()=>{e.addEventListener("scroll",o),this.destroyScrollListener=()=>{e.removeEventListener("scroll",o)}})},this.exitInputMode=()=>{const{parentEl:t}=this;t!=null&&(t.exitInputMode(),this.el.classList.remove("picker-column-active"))},this.isActive=!1,this.items=[],this.value=void 0,this.color="primary",this.numericInput=!1}valueChange(){this.isColumnVisible&&this.scrollActiveItemIntoView()}componentWillLoad(){const s=e=>{if(e[0].isIntersecting){const{activeItem:r,el:o}=this;this.isColumnVisible=!0;const n=g(o).querySelector(`.${f}`);n&&this.setPickerItemActiveState(n,!1),this.scrollActiveItemIntoView(),r&&this.setPickerItemActiveState(r,!0),this.initializeScrollListener()}else this.isColumnVisible=!1,this.destroyScrollListener&&(this.destroyScrollListener(),this.destroyScrollListener=void 0)};new IntersectionObserver(s,{threshold:.001}).observe(this.el);const t=this.parentEl=this.el.closest("ion-picker-internal");t!==null&&t.addEventListener("ionInputModeChange",e=>this.inputModeChange(e))}componentDidRender(){var s;const{activeItem:t,items:e,isColumnVisible:i,value:r}=this;i&&(t?this.scrollActiveItemIntoView():((s=e[0])===null||s===void 0?void 0:s.value)!==r&&this.setValue(e[0].value))}async scrollActiveItemIntoView(){const s=this.activeItem;s&&this.centerPickerItemInView(s,!1,!1)}async setValue(s){const{items:t}=this;this.value=s;const e=t.find(i=>i.value===s&&i.disabled!==!0);e&&this.ionChange.emit(e)}get activeItem(){return g(this.el).querySelector(`.picker-item[data-value="${this.value}"]:not([disabled])`)}render(){const{items:s,color:t,isActive:e,numericInput:i}=this,r=P(this);return a(x,{exportparts:`${w}, ${b}`,tabindex:0,class:N(t,{[r]:!0,"picker-column-active":e,"picker-column-numeric-input":i})},a("div",{class:"picker-item picker-item-empty","aria-hidden":"true"},"\xA0"),a("div",{class:"picker-item picker-item-empty","aria-hidden":"true"},"\xA0"),a("div",{class:"picker-item picker-item-empty","aria-hidden":"true"},"\xA0"),s.map((o,n)=>a("button",{tabindex:"-1",class:{"picker-item":!0,"picker-item-disabled":o.disabled||!1},"data-value":o.value,"data-index":n,onClick:l=>{this.centerPickerItemInView(l.target,!0)},disabled:o.disabled,part:w},o.text)),a("div",{class:"picker-item picker-item-empty","aria-hidden":"true"},"\xA0"),a("div",{class:"picker-item picker-item-empty","aria-hidden":"true"},"\xA0"),a("div",{class:"picker-item picker-item-empty","aria-hidden":"true"},"\xA0"))}get el(){return I(this)}static get watchers(){return{value:["valueChange"]}}},f="picker-item-active",w="wheel-item",b="active";C.style={ios:V,md:O};const z=":host{display:flex;position:relative;align-items:center;justify-content:center;width:100%;height:200px;direction:ltr;z-index:0}:host .picker-before,:host .picker-after{position:absolute;width:100%;transform:translateZ(0);z-index:1;pointer-events:none}:host .picker-before{top:0;height:83px}@supports (inset-inline-start: 0){:host .picker-before{inset-inline-start:0}}@supports not (inset-inline-start: 0){:host .picker-before{left:0}:host-context([dir=rtl]) .picker-before{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){:host .picker-before:dir(rtl){left:unset;right:unset;right:0}}}:host .picker-after{top:116px;height:84px}@supports (inset-inline-start: 0){:host .picker-after{inset-inline-start:0}}@supports not (inset-inline-start: 0){:host .picker-after{left:0}:host-context([dir=rtl]) .picker-after{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){:host .picker-after:dir(rtl){left:unset;right:unset;right:0}}}:host .picker-highlight{border-radius:8px;left:0;right:0;top:50%;bottom:0;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:0;margin-bottom:0;position:absolute;width:calc(100% - 16px);height:34px;transform:translateY(-50%);background:var(--wheel-highlight-background);z-index:-1}:host input{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;margin:0;padding:0;border:0;outline:0;clip:rect(0 0 0 0);opacity:0;overflow:hidden;-webkit-appearance:none;-moz-appearance:none}:host ::slotted(ion-picker-column-internal:first-of-type){text-align:start}:host ::slotted(ion-picker-column-internal:last-of-type){text-align:end}:host ::slotted(ion-picker-column-internal:only-child){text-align:center}:host .picker-before{background:linear-gradient(to bottom, rgba(var(--wheel-fade-background-rgb, var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255))), 1) 20%, rgba(var(--wheel-fade-background-rgb, var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255))), 0.8) 100%)}:host .picker-after{background:linear-gradient(to top, rgba(var(--wheel-fade-background-rgb, var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255))), 1) 20%, rgba(var(--wheel-fade-background-rgb, var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255))), 0.8) 100%)}:host .picker-highlight{background:var(--wheel-highlight-background, var(--ion-color-step-150, #eeeeef))}",T=":host{display:flex;position:relative;align-items:center;justify-content:center;width:100%;height:200px;direction:ltr;z-index:0}:host .picker-before,:host .picker-after{position:absolute;width:100%;transform:translateZ(0);z-index:1;pointer-events:none}:host .picker-before{top:0;height:83px}@supports (inset-inline-start: 0){:host .picker-before{inset-inline-start:0}}@supports not (inset-inline-start: 0){:host .picker-before{left:0}:host-context([dir=rtl]) .picker-before{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){:host .picker-before:dir(rtl){left:unset;right:unset;right:0}}}:host .picker-after{top:116px;height:84px}@supports (inset-inline-start: 0){:host .picker-after{inset-inline-start:0}}@supports not (inset-inline-start: 0){:host .picker-after{left:0}:host-context([dir=rtl]) .picker-after{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){:host .picker-after:dir(rtl){left:unset;right:unset;right:0}}}:host .picker-highlight{border-radius:8px;left:0;right:0;top:50%;bottom:0;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:0;margin-bottom:0;position:absolute;width:calc(100% - 16px);height:34px;transform:translateY(-50%);background:var(--wheel-highlight-background);z-index:-1}:host input{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;margin:0;padding:0;border:0;outline:0;clip:rect(0 0 0 0);opacity:0;overflow:hidden;-webkit-appearance:none;-moz-appearance:none}:host ::slotted(ion-picker-column-internal:first-of-type){text-align:start}:host ::slotted(ion-picker-column-internal:last-of-type){text-align:end}:host ::slotted(ion-picker-column-internal:only-child){text-align:center}:host .picker-before{background:linear-gradient(to bottom, rgba(var(--wheel-fade-background-rgb, var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255))), 1) 20%, rgba(var(--wheel-fade-background-rgb, var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255))), 0) 90%)}:host .picker-after{background:linear-gradient(to top, rgba(var(--wheel-fade-background-rgb, var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255))), 1) 30%, rgba(var(--wheel-fade-background-rgb, var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255))), 0) 90%)}",M=class{constructor(s){k(this,s),this.ionInputModeChange=v(this,"ionInputModeChange",7),this.useInputMode=!1,this.isInHighlightBounds=t=>{const{highlightEl:e}=this;if(!e)return!1;const i=e.getBoundingClientRect(),r=t.clientX<i.left||t.clientX>i.right,o=t.clientY<i.top||t.clientY>i.bottom;return!(r||o)},this.onFocusOut=t=>{const{relatedTarget:e}=t;(!e||e.tagName!=="ION-PICKER-COLUMN-INTERNAL"&&e!==this.inputEl)&&this.exitInputMode()},this.onFocusIn=t=>{const{target:e}=t;if(e.tagName==="ION-PICKER-COLUMN-INTERNAL"&&!this.actionOnClick){const i=e;i.numericInput?this.enterInputMode(i,!1):this.exitInputMode()}},this.onClick=()=>{const{actionOnClick:t}=this;t&&(t(),this.actionOnClick=void 0)},this.onPointerDown=t=>{const{useInputMode:e,inputModeColumn:i,el:r}=this;if(this.isInHighlightBounds(t)){if(e)t.target.tagName==="ION-PICKER-COLUMN-INTERNAL"?i&&i===t.target?this.actionOnClick=()=>{this.enterInputMode()}:this.actionOnClick=()=>{this.enterInputMode(t.target)}:this.actionOnClick=()=>{this.exitInputMode()};else{const n=r.querySelectorAll("ion-picker-column-internal.picker-column-numeric-input").length===1?t.target:void 0;this.actionOnClick=()=>{this.enterInputMode(n)}}return}this.actionOnClick=()=>{this.exitInputMode()}},this.enterInputMode=(t,e=!0)=>{const{inputEl:i,el:r}=this;!i||!r.querySelector("ion-picker-column-internal.picker-column-numeric-input")||(this.useInputMode=!0,this.inputModeColumn=t,e?(this.destroyKeypressListener&&(this.destroyKeypressListener(),this.destroyKeypressListener=void 0),i.focus()):(r.addEventListener("keypress",this.onKeyPress),this.destroyKeypressListener=()=>{r.removeEventListener("keypress",this.onKeyPress)}),this.emitInputModeChange())},this.onKeyPress=t=>{const{inputEl:e}=this;if(!e)return;const i=parseInt(t.key,10);Number.isNaN(i)||(e.value+=t.key,this.onInputChange())},this.selectSingleColumn=()=>{const{inputEl:t,inputModeColumn:e,singleColumnSearchTimeout:i}=this;if(!t||!e)return;const r=e.items.filter(n=>n.disabled!==!0);if(i&&clearTimeout(i),this.singleColumnSearchTimeout=setTimeout(()=>{t.value="",this.singleColumnSearchTimeout=void 0},1e3),t.value.length>=3){const n=t.value.length-2,l=t.value.substring(n);t.value=l,this.selectSingleColumn();return}const o=r.find(({text:n})=>n.replace(/^0+(?=[1-9])|0+(?=0$)/,"")===t.value);if(o){e.setValue(o.value);return}if(t.value.length===2){const n=t.value.substring(t.value.length-1);t.value=n,this.selectSingleColumn()}},this.searchColumn=(t,e,i="start")=>{const r=i==="start"?/^0+/:/0$/,o=t.items.find(({text:n,disabled:l})=>l!==!0&&n.replace(r,"")===e);o&&t.setValue(o.value)},this.selectMultiColumn=()=>{const{inputEl:t,el:e}=this;if(!t)return;const i=Array.from(e.querySelectorAll("ion-picker-column-internal")).filter(h=>h.numericInput),r=i[0],o=i[1];let n=t.value,l;switch(n.length){case 1:this.searchColumn(r,n);break;case 2:const h=t.value.substring(0,1);n=h==="0"||h==="1"?t.value:h,this.searchColumn(r,n),n.length===1&&(l=t.value.substring(t.value.length-1),this.searchColumn(o,l,"end"));break;case 3:const c=t.value.substring(0,1);n=c==="0"||c==="1"?t.value.substring(0,2):c,this.searchColumn(r,n),l=n.length===1?t.value.substring(1):t.value.substring(2),this.searchColumn(o,l,"end");break;case 4:const u=t.value.substring(0,1);n=u==="0"||u==="1"?t.value.substring(0,2):u,this.searchColumn(r,n);const d=n.length===1?t.value.substring(1,t.value.length):t.value.substring(2,t.value.length);this.searchColumn(o,d,"end");break;default:const m=t.value.length-4,p=t.value.substring(m);t.value=p,this.selectMultiColumn();break}},this.onInputChange=()=>{const{useInputMode:t,inputEl:e,inputModeColumn:i}=this;!t||!e||(i?this.selectSingleColumn():this.selectMultiColumn())},this.emitInputModeChange=()=>{const{useInputMode:t,inputModeColumn:e}=this;this.ionInputModeChange.emit({useInputMode:t,inputModeColumn:e})}}preventTouchStartPropagation(s){s.stopPropagation()}componentWillLoad(){g(this.el).addEventListener("focusin",this.onFocusIn),g(this.el).addEventListener("focusout",this.onFocusOut)}async exitInputMode(){const{inputEl:s,useInputMode:t}=this;!t||!s||(this.useInputMode=!1,this.inputModeColumn=void 0,s.blur(),s.value="",this.destroyKeypressListener&&(this.destroyKeypressListener(),this.destroyKeypressListener=void 0),this.emitInputModeChange())}render(){return a(x,{onPointerDown:s=>this.onPointerDown(s),onClick:()=>this.onClick()},a("input",{"aria-hidden":"true",tabindex:-1,inputmode:"numeric",type:"number",ref:s=>this.inputEl=s,onInput:()=>this.onInputChange(),onBlur:()=>this.exitInputMode()}),a("div",{class:"picker-before"}),a("div",{class:"picker-after"}),a("div",{class:"picker-highlight",ref:s=>this.highlightEl=s}),a("slot",null))}get el(){return I(this)}};M.style={ios:z,md:T};export{C as ion_picker_column_internal,M as ion_picker_internal};
