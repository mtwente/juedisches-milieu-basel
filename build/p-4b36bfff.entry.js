import{r as h,h as t,H as c,e as E}from"./p-1bafedb0.js";import{s as u}from"./p-855a8bbd.js";import{s as m,g as f,a as g}from"./p-1445007b.js";import{d as b}from"./p-6bc8d60f.js";const L=":host{display:inline;vertical-align:middle}a{color:var(--gv-class-link-color, black);text-decoration:var(--gv-class-link-decoration, none)}",R=o=>`
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX geov: <http://geovistory.org/resource/>

SELECT ?classLabel ?t
WHERE {
  geov:${o} rdf:type ?t.
  optional{?t rdfs:label ?classLabel}
}
LIMIT 1
`,v=class{constructor(o){h(this,o),this._ssrId=void 0,this.sparqlEndpoint=void 0,this.entityId=void 0,this.withIcon=!1,this.data=void 0,m(this)}async componentWillLoad(){this.data=f(this._ssrId),this.data||(this.data={loading:!0},await this.fetchData().then(o=>(this.data=o,g(this._ssrId,o),o)).catch(o=>(this.data=o,o)))}async fetchData(){return u(this.sparqlEndpoint,R(this.entityId)).then(o=>{var i,n,a,r,e,s,l,d;return Object.assign(Object.assign({},this.data),{label:(r=(a=(n=(i=o?.results)===null||i===void 0?void 0:i.bindings)===null||n===void 0?void 0:n[0])===null||a===void 0?void 0:a.classLabel)===null||r===void 0?void 0:r.value,classURI:(d=(l=(s=(e=o?.results)===null||e===void 0?void 0:e.bindings)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.t)===null||d===void 0?void 0:d.value,loading:!1})}).catch(o=>Object.assign(Object.assign({},this.data),{error:!0,loading:!1}))}render(){return t(c,null,t("a",{href:this.data.classURI,target:"_blank"},this.withIcon&&t("geov-entity-class-icon",{classURI:this.data.classURI}),this.data.label,this.data.loading&&"loading...",this.data.error&&"error!",!this.data.label&&!this.data.loading&&!this.data.error&&t("span",{class:"no-label-found"},"no label found")))}};v.style=L;const k=":host{display:block}",F=o=>`
PREFIX ontome: <https://ontome.net/ontology/>
PREFIX geov: <http://geovistory.org/resource/>

SELECT  ?definition
WHERE {
  geov:${o} ontome:p1762 / ontome:p1864 ?definition;
}
LIMIT 10
`,y=class{constructor(o){h(this,o),this._ssrId=void 0,this.sparqlEndpoint=void 0,this.entityId=void 0,this.emptyPlaceholder="",this.data=void 0,m(this)}async componentWillLoad(){this.data=f(this._ssrId),this.data||(this.data={loading:!0},await this.fetchData().then(o=>(this.data=o,g(this._ssrId,o),o)).catch(o=>(this.data=o,o)))}async fetchData(){return u(this.sparqlEndpoint,F(this.entityId)).then(o=>{var i,n;return Object.assign(Object.assign({},this.data),{definitions:(n=(i=o?.results)===null||i===void 0?void 0:i.bindings)===null||n===void 0?void 0:n.map(a=>{var r;return(r=a.definition)===null||r===void 0?void 0:r.value}),loading:!1})}).catch(o=>Object.assign(Object.assign({},this.data),{error:!0,loading:!1}))}render(){return t(c,null,this.data.definitions.map(o=>t("p",{class:"definition"},o)),this.data.loading&&"loading...",this.data.error&&"error!",!this.data.definitions.length&&!this.data.loading&&!this.data.error&&this.emptyPlaceholder&&t("span",{class:"no-label-found"},this.emptyPlaceholder),t("slot",null))}};y.style=k;const j=":host{display:block}",w=class{constructor(o){h(this,o),this.entityId=void 0,this.projectId=void 0,this.color=void 0,this.expand=void 0,this.fill=void 0,this.buttonLabel="Download RDF",this.buttonIcon=void 0,this.listFormat={"RDF XML":["application/rdf+xml",".rdf"],"JSON-LD":["application/ld+json",".jsonld"],"N-Triples":["application/n-triples",".nt"],"N-Quads":["application/n-quads",".nq"],TRIX:["application/trix+xml",".trix"],Thrift:["application/rdf+thrift",".thrift"],Turtle:["text/turtle",".ttl"]},this.response=void 0}open(){this.modal.present()}dismiss(){this.modal.dismiss()}async fetchRDF(o){const i=new Headers({Accept:o[0]});let n=this.entityId;this.projectId!=null&&(n+="?p="+this.projectId);const r=await fetch("https://www.geovistory.org/resource/"+n,{method:"GET",headers:i,mode:"cors",cache:"default"});this.response=await r.blob();const e=document.createElement("a");e.href=URL.createObjectURL(this.response),e.download=this.entityId+o[1],e.click(),this.dismiss()}renderClickableItem(){return Object.entries(this.listFormat).map(([o,i])=>t("ion-item",{button:!0,detail:!1,onClick:()=>this.fetchRDF(i),download:"Download"},this.buttonIcon?t("ion-icon",{slot:"start",name:this.buttonIcon}):t("ion-icon",{slot:"start",icon:b}),t("ion-label",null,o)))}render(){return t(c,null,t("ion-button",{expand:this.expand,fill:this.fill,color:this.color,onClick:()=>this.open()},this.buttonLabel," ",this.buttonIcon?t("ion-icon",{slot:"end",name:this.buttonIcon}):t("ion-icon",{slot:"end",icon:b})),t("ion-modal",{ref:o=>this.modal=o,onWillDismiss:()=>this.dismiss(),isOpen:!1},t("ion-header",null,t("ion-toolbar",null,t("ion-buttons",{slot:"start"},t("ion-button",{onClick:()=>this.dismiss()},"Cancel")),t("ion-title",null,"Download RDF"))),t("ion-content",{class:"ion-padding"},t("ion-list",{lines:"none"},this.renderClickableItem()))),t("slot",null))}};w.style=j;const _=":host{display:block;margin-top:0}",C=o=>`
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX geov: <http://geovistory.org/resource/>

SELECT ?o
WHERE {
  geov:${o} rdfs:label ?o .
}
LIMIT 1
`,x=class{constructor(o){h(this,o),this._ssrId=void 0,this.sparqlEndpoint=void 0,this.entityId=void 0,this.data=void 0,m(this)}async componentWillLoad(){this.data=f(this._ssrId),this.data||(this.data={loading:!0},await this.fetchData().then(o=>(this.data=o,g(this._ssrId,o),o)).catch(o=>(this.data=o,o)))}async fetchData(){return u(this.sparqlEndpoint,C(this.entityId)).then(o=>{var i,n,a,r;return Object.assign(Object.assign({},this.data),{label:(r=(a=(n=(i=o?.results)===null||i===void 0?void 0:i.bindings)===null||n===void 0?void 0:n[0])===null||a===void 0?void 0:a.o)===null||r===void 0?void 0:r.value,loading:!1})}).catch(o=>Object.assign(Object.assign({},this.data),{error:!0,loading:!1}))}render(){return t(c,null,this.data.label,this.data.loading&&"loading...",this.data.error&&"error!",!this.data.label&&!this.data.loading&&!this.data.error&&t("span",{class:"no-label-found"},"no label found"),t("slot",null))}};x.style=_;const O='html.ios{--ion-default-font:-apple-system, BlinkMacSystemFont, "Helvetica Neue", "Roboto", sans-serif}html.md{--ion-default-font:"Roboto", "Helvetica Neue", sans-serif}html{--ion-font-family:var(--ion-default-font)}body{background:var(--ion-background-color)}body.backdrop-no-scroll{overflow:hidden}html.ios ion-modal.modal-card ion-header ion-toolbar:first-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:first-of-type,html.ios ion-modal ion-footer ion-toolbar:first-of-type{padding-top:6px}html.ios ion-modal.modal-card ion-header ion-toolbar:last-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:last-of-type{padding-bottom:6px}html.ios ion-modal ion-toolbar{padding-right:calc(var(--ion-safe-area-right) + 8px);padding-left:calc(var(--ion-safe-area-left) + 8px)}@media screen and (min-width: 768px){html.ios ion-modal.modal-card:first-of-type{--backdrop-opacity:0.18}}ion-modal.modal-default.show-modal~ion-modal.modal-default{--backdrop-opacity:0;--box-shadow:none}html.ios ion-modal.modal-card .ion-page{border-top-left-radius:var(--border-radius)}.ion-color-primary{--ion-color-base:var(--ion-color-primary, #3880ff) !important;--ion-color-base-rgb:var(--ion-color-primary-rgb, 56, 128, 255) !important;--ion-color-contrast:var(--ion-color-primary-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-primary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-primary-shade, #3171e0) !important;--ion-color-tint:var(--ion-color-primary-tint, #4c8dff) !important}.ion-color-secondary{--ion-color-base:var(--ion-color-secondary, #3dc2ff) !important;--ion-color-base-rgb:var(--ion-color-secondary-rgb, 61, 194, 255) !important;--ion-color-contrast:var(--ion-color-secondary-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-secondary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-secondary-shade, #36abe0) !important;--ion-color-tint:var(--ion-color-secondary-tint, #50c8ff) !important}.ion-color-tertiary{--ion-color-base:var(--ion-color-tertiary, #5260ff) !important;--ion-color-base-rgb:var(--ion-color-tertiary-rgb, 82, 96, 255) !important;--ion-color-contrast:var(--ion-color-tertiary-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-tertiary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-tertiary-shade, #4854e0) !important;--ion-color-tint:var(--ion-color-tertiary-tint, #6370ff) !important}.ion-color-success{--ion-color-base:var(--ion-color-success, #2dd36f) !important;--ion-color-base-rgb:var(--ion-color-success-rgb, 45, 211, 111) !important;--ion-color-contrast:var(--ion-color-success-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-success-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-success-shade, #28ba62) !important;--ion-color-tint:var(--ion-color-success-tint, #42d77d) !important}.ion-color-warning{--ion-color-base:var(--ion-color-warning, #ffc409) !important;--ion-color-base-rgb:var(--ion-color-warning-rgb, 255, 196, 9) !important;--ion-color-contrast:var(--ion-color-warning-contrast, #000) !important;--ion-color-contrast-rgb:var(--ion-color-warning-contrast-rgb, 0, 0, 0) !important;--ion-color-shade:var(--ion-color-warning-shade, #e0ac08) !important;--ion-color-tint:var(--ion-color-warning-tint, #ffca22) !important}.ion-color-danger{--ion-color-base:var(--ion-color-danger, #eb445a) !important;--ion-color-base-rgb:var(--ion-color-danger-rgb, 235, 68, 90) !important;--ion-color-contrast:var(--ion-color-danger-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-danger-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-danger-shade, #cf3c4f) !important;--ion-color-tint:var(--ion-color-danger-tint, #ed576b) !important}.ion-color-light{--ion-color-base:var(--ion-color-light, #f4f5f8) !important;--ion-color-base-rgb:var(--ion-color-light-rgb, 244, 245, 248) !important;--ion-color-contrast:var(--ion-color-light-contrast, #000) !important;--ion-color-contrast-rgb:var(--ion-color-light-contrast-rgb, 0, 0, 0) !important;--ion-color-shade:var(--ion-color-light-shade, #d7d8da) !important;--ion-color-tint:var(--ion-color-light-tint, #f5f6f9) !important}.ion-color-medium{--ion-color-base:var(--ion-color-medium, #92949c) !important;--ion-color-base-rgb:var(--ion-color-medium-rgb, 146, 148, 156) !important;--ion-color-contrast:var(--ion-color-medium-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-medium-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-medium-shade, #808289) !important;--ion-color-tint:var(--ion-color-medium-tint, #9d9fa6) !important}.ion-color-dark{--ion-color-base:var(--ion-color-dark, #222428) !important;--ion-color-base-rgb:var(--ion-color-dark-rgb, 34, 36, 40) !important;--ion-color-contrast:var(--ion-color-dark-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-dark-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-dark-shade, #1e2023) !important;--ion-color-tint:var(--ion-color-dark-tint, #383a3e) !important}.ion-page{left:0;right:0;top:0;bottom:0;display:flex;position:absolute;flex-direction:column;justify-content:space-between;contain:layout size style;overflow:hidden;z-index:0}ion-modal>.ion-page{position:relative;contain:layout style;height:100%}.split-pane-visible>.ion-page.split-pane-main{position:relative}ion-route,ion-route-redirect,ion-router,ion-select-option,ion-nav-controller,ion-menu-controller,ion-action-sheet-controller,ion-alert-controller,ion-loading-controller,ion-modal-controller,ion-picker-controller,ion-popover-controller,ion-toast-controller,.ion-page-hidden{display:none !important}.ion-page-invisible{opacity:0}.can-go-back>ion-header ion-back-button{display:block}html.plt-ios.plt-hybrid,html.plt-ios.plt-pwa{--ion-statusbar-padding:20px}@supports (padding-top: 20px){html{--ion-safe-area-top:var(--ion-statusbar-padding)}}@supports (padding-top: constant(safe-area-inset-top)){html{--ion-safe-area-top:constant(safe-area-inset-top);--ion-safe-area-bottom:constant(safe-area-inset-bottom);--ion-safe-area-left:constant(safe-area-inset-left);--ion-safe-area-right:constant(safe-area-inset-right)}}@supports (padding-top: env(safe-area-inset-top)){html{--ion-safe-area-top:env(safe-area-inset-top);--ion-safe-area-bottom:env(safe-area-inset-bottom);--ion-safe-area-left:env(safe-area-inset-left);--ion-safe-area-right:env(safe-area-inset-right)}}ion-card.ion-color .ion-inherit-color,ion-card-header.ion-color .ion-inherit-color{color:inherit}.menu-content{transform:translate3d(0,  0,  0)}.menu-content-open{cursor:pointer;touch-action:manipulation;pointer-events:none}.ios .menu-content-reveal{box-shadow:-8px 0 42px rgba(0, 0, 0, 0.08)}[dir=rtl].ios .menu-content-reveal{box-shadow:8px 0 42px rgba(0, 0, 0, 0.08)}.md .menu-content-reveal{box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18)}.md .menu-content-push{box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18)}ion-accordion-group.accordion-group-expand-inset>ion-accordion:first-of-type{border-top-left-radius:8px;border-top-right-radius:8px}ion-accordion-group.accordion-group-expand-inset>ion-accordion:last-of-type{border-bottom-left-radius:8px;border-bottom-right-radius:8px}ion-accordion-group>ion-accordion:last-of-type ion-item[slot=header]{--border-width:0px}ion-accordion.accordion-animated>[slot=header] .ion-accordion-toggle-icon{transition:300ms transform cubic-bezier(0.25, 0.8, 0.5, 1)}@media (prefers-reduced-motion: reduce){ion-accordion .ion-accordion-toggle-icon{transition:none !important}}ion-accordion.accordion-expanding>[slot=header] .ion-accordion-toggle-icon,ion-accordion.accordion-expanded>[slot=header] .ion-accordion-toggle-icon{transform:rotate(180deg)}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-previous ion-item[slot=header]{--border-width:0px;--inner-border-width:0px}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanding:first-of-type,ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanded:first-of-type{margin-top:0}ion-input input::-webkit-date-and-time-value{text-align:start}.ion-datetime-button-overlay{--width:fit-content;--height:fit-content}.ion-datetime-button-overlay ion-datetime.datetime-grid{width:320px;min-height:320px}:host.container,.container{display:block;column-count:var(--column-count);column-gap:var(--column-gap);column-rule-style:var(--column-rule-style);column-rule-width:var(--column-rule-width);column-rule-color:var(--column-rule-color);column-rule:var(--column-rule);column-span:var(--column-span);column-width:var(--column-width)}.predicateContainer{padding:var(--ion-padding)}.predicateContainer~.predicateContainer{margin-top:2rem}',P=(o,i,n,a)=>{let r;const e=l=>l.split(",").map(d=>`${d.trim()}`);let s="";return a&&(s=`FILTER (str(?predicate) NOT IN (
      ${e(a).map(p=>`"${p}"`).join(`,
        `)}
      ))`),n?r=`SELECT * {
      ${e(n).map(p=>`
      {
        SELECT (<${p}> as ?predicate) ?predicateLabel (count(distinct ?object) as ?count)
        WHERE {
          <${o}> <${p}> ?object .
          OPTIONAL {
            <${p}> rdfs:label ?predicateLabel .
            FILTER(LANG(?predicateLabel) IN ("${i}", "en"))
          } .
          ${s}
        }
        GROUP BY ?predicate ?predicateLabel
      }`).join(`
UNION
`)}
    }`:r=`
    SELECT ?predicate ?predicateLabel (count(distinct ?object) as ?count)
    WHERE {
      <${o}> ?predicate ?object .
      OPTIONAL {
        ?predicate rdfs:label ?predicateLabel .
        FILTER(LANG(?predicateLabel) IN ("${i}", "en"))
      } .
      ${s}
    }
    GROUP BY ?predicate ?predicateLabel
    `,`
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX xml: <http://www.w3.org/XML/1998/namespace>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX geo: <http://www.opengis.net/ont/geosparql#>
PREFIX time: <http://www.w3.org/2006/time#>
PREFIX ontome: <https://ontome.net/ontology/>
PREFIX geov: <http://geovistory.org/resource/>

${r}
`},I=class{constructor(o){h(this,o),this.dataFetched=E(this,"dataFetched",7),this._ssrId=void 0,this.data=void 0,this.sparqlEndpoint=void 0,this.entityUri=void 0,this.language="en",this.fetchBeforeRender=!0,this.uriRegex=void 0,this.uriReplace=void 0,this.color="",this.predicateInclude=void 0,this.predicateExclude=void 0,this.fixedGrid=void 0,m(this)}async componentWillLoad(){this.fetchBeforeRender&&(this.data=f(this._ssrId)),this.data||(this.data={loading:!0},await this.fetchData().then(o=>{var i;return o.propsWithCount=this.filterByLanguage((i=o.propsWithCount)!==null&&i!==void 0?i:[],this.language),this.data=o,g(this._ssrId,o),this.dataFetched.emit(o),o}).catch(o=>(this.data=o,o)))}filterByLanguage(o,i){return o.map(n=>{o.filter(a=>n.predicate.value==a.predicate.value&&n!=a&&n.predicateLabel["xml:lang"]==a.predicateLabel["xml:lang"]).forEach(a=>{n.predicateLabel.value+=", "+a.predicateLabel.value,a.predicateLabel["xml:lang"]="deactivate"})}),o.filter(n=>o.filter(a=>n.predicate.value==a.predicate.value&&n!=a).length?n.predicateLabel["xml:lang"]==i:!0)}async fetchData(){let o={loading:!0};const i=P(this.entityUri,this.language,this.predicateInclude,this.predicateExclude);return await u(this.sparqlEndpoint,i).then(n=>{var a;o={loading:!1,propsWithCount:(a=n?.results)===null||a===void 0?void 0:a.bindings}}).catch(n=>{o={loading:!1,error:!0}}),o}render(){return this.fixedGrid?t(c,null,t("ion-grid",{fixed:!0,class:"container"},this.renderCards())):t(c,{class:"container"},this.renderCards())}renderCards(){return this.data.propsWithCount.map(o=>{var i;return t("div",{class:"predicateContainer"},t("geov-entity-props-by-predicate",{entityUri:this.entityUri,sparqlEndpoint:this.sparqlEndpoint,totalCount:Number(o.count.value),predicateUri:o.predicate.value,predicateLabel:o.predicateLabel?(i=o.predicateLabel)===null||i===void 0?void 0:i.value:o.predicate.value.replace("http://www.w3.org/2000/01/rdf-schema#","rdfs:").replace("http://www.w3.org/1999/02/22-rdf-syntax-ns#","rdf:"),uriRegex:this.uriRegex,uriReplace:this.uriReplace,color:this.color}))})}};I.style=O;export{v as geov_entity_class_label,y as geov_entity_definition,w as geov_entity_download_rdf,x as geov_entity_label,I as geov_entity_properties};
