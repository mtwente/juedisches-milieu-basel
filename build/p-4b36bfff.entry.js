import{r as o,h as t,H as n,e as i}from"./p-1bafedb0.js";import{s as r}from"./p-855a8bbd.js";import{s as a,g as e,a as s}from"./p-1445007b.js";import{d as l}from"./p-6bc8d60f.js";const c=":host{display:inline;vertical-align:middle}a{color:var(--gv-class-link-color, black);text-decoration:var(--gv-class-link-decoration, none)}";const d=o=>`\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX geov: <http://geovistory.org/resource/>\n\nSELECT ?classLabel ?t\nWHERE {\n  geov:${o} rdf:type ?t.\n  optional{?t rdfs:label ?classLabel}\n}\nLIMIT 1\n`;const p=class{constructor(t){o(this,t);this._ssrId=undefined;this.sparqlEndpoint=undefined;this.entityId=undefined;this.withIcon=false;this.data=undefined;a(this)}async componentWillLoad(){this.data=e(this._ssrId);if(!this.data){this.data={loading:true};await this.fetchData().then((o=>{this.data=o;s(this._ssrId,o);return o})).catch((o=>{this.data=o;return o}))}}async fetchData(){return r(this.sparqlEndpoint,d(this.entityId)).then((o=>{var t,n,i,r,a,e,s,l;return Object.assign(Object.assign({},this.data),{label:(r=(i=(n=(t=o===null||o===void 0?void 0:o.results)===null||t===void 0?void 0:t.bindings)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.classLabel)===null||r===void 0?void 0:r.value,classURI:(l=(s=(e=(a=o===null||o===void 0?void 0:o.results)===null||a===void 0?void 0:a.bindings)===null||e===void 0?void 0:e[0])===null||s===void 0?void 0:s.t)===null||l===void 0?void 0:l.value,loading:false})})).catch((o=>Object.assign(Object.assign({},this.data),{error:true,loading:false})))}render(){return t(n,null,t("a",{href:this.data.classURI,target:"_blank"},this.withIcon&&t("geov-entity-class-icon",{classURI:this.data.classURI}),this.data.label,this.data.loading&&`loading...`,this.data.error&&`error!`,!this.data.label&&!this.data.loading&&!this.data.error&&t("span",{class:"no-label-found"},"no label found")))}};p.style=c;const h=":host{display:block}";const u=o=>`\nPREFIX ontome: <https://ontome.net/ontology/>\nPREFIX geov: <http://geovistory.org/resource/>\n\nSELECT  ?definition\nWHERE {\n  geov:${o} ontome:p1762 / ontome:p1864 ?definition;\n}\nLIMIT 10\n`;const f=class{constructor(t){o(this,t);this._ssrId=undefined;this.sparqlEndpoint=undefined;this.entityId=undefined;this.emptyPlaceholder="";this.data=undefined;a(this)}async componentWillLoad(){this.data=e(this._ssrId);if(!this.data){this.data={loading:true};await this.fetchData().then((o=>{this.data=o;s(this._ssrId,o);return o})).catch((o=>{this.data=o;return o}))}}async fetchData(){return r(this.sparqlEndpoint,u(this.entityId)).then((o=>{var t,n;return Object.assign(Object.assign({},this.data),{definitions:(n=(t=o===null||o===void 0?void 0:o.results)===null||t===void 0?void 0:t.bindings)===null||n===void 0?void 0:n.map((o=>{var t;return(t=o.definition)===null||t===void 0?void 0:t.value})),loading:false})})).catch((o=>Object.assign(Object.assign({},this.data),{error:true,loading:false})))}render(){return t(n,null,this.data.definitions.map((o=>t("p",{class:"definition"},o))),this.data.loading&&`loading...`,this.data.error&&`error!`,!this.data.definitions.length&&!this.data.loading&&!this.data.error&&this.emptyPlaceholder&&t("span",{class:"no-label-found"},this.emptyPlaceholder),t("slot",null))}};f.style=h;const m=":host{display:block}";const g=class{constructor(t){o(this,t);this.entityId=undefined;this.projectId=undefined;this.color=undefined;this.expand=undefined;this.fill=undefined;this.buttonLabel="Download RDF";this.buttonIcon=undefined;this.listFormat={"RDF XML":["application/rdf+xml",".rdf"],"JSON-LD":["application/ld+json",".jsonld"],"N-Triples":["application/n-triples",".nt"],"N-Quads":["application/n-quads",".nq"],TRIX:["application/trix+xml",".trix"],Thrift:["application/rdf+thrift",".thrift"],Turtle:["text/turtle",".ttl"]};this.response=undefined}open(){this.modal.present()}dismiss(){this.modal.dismiss()}async fetchRDF(o){const t=new Headers({Accept:o[0]});let n=this.entityId;if(this.projectId!=undefined){n+="?p="+this.projectId}const i="https://www.geovistory.org/resource/";const r=await fetch(i+n,{method:"GET",headers:t,mode:"cors",cache:"default"});this.response=await r.blob();const a=document.createElement("a");a.href=URL.createObjectURL(this.response);a.download=this.entityId+o[1];a.click();this.dismiss()}renderClickableItem(){return Object.entries(this.listFormat).map((([o,n])=>t("ion-item",{button:true,detail:false,onClick:()=>this.fetchRDF(n),download:"Download"},this.buttonIcon?t("ion-icon",{slot:"start",name:this.buttonIcon}):t("ion-icon",{slot:"start",icon:l}),t("ion-label",null,o))))}render(){return t(n,null,t("ion-button",{expand:this.expand,fill:this.fill,color:this.color,onClick:()=>this.open()},this.buttonLabel," ",this.buttonIcon?t("ion-icon",{slot:"end",name:this.buttonIcon}):t("ion-icon",{slot:"end",icon:l})),t("ion-modal",{ref:o=>this.modal=o,onWillDismiss:()=>this.dismiss(),isOpen:false},t("ion-header",null,t("ion-toolbar",null,t("ion-buttons",{slot:"start"},t("ion-button",{onClick:()=>this.dismiss()},"Cancel")),t("ion-title",null,"Download RDF"))),t("ion-content",{class:"ion-padding"},t("ion-list",{lines:"none"},this.renderClickableItem()))),t("slot",null))}};g.style=m;const b=":host{display:block;margin-top:0}";const v=o=>`\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX geov: <http://geovistory.org/resource/>\n\nSELECT ?o\nWHERE {\n  geov:${o} rdfs:label ?o .\n}\nLIMIT 1\n`;const w=class{constructor(t){o(this,t);this._ssrId=undefined;this.sparqlEndpoint=undefined;this.entityId=undefined;this.data=undefined;a(this)}async componentWillLoad(){this.data=e(this._ssrId);if(!this.data){this.data={loading:true};await this.fetchData().then((o=>{this.data=o;s(this._ssrId,o);return o})).catch((o=>{this.data=o;return o}))}}async fetchData(){return r(this.sparqlEndpoint,v(this.entityId)).then((o=>{var t,n,i,r;return Object.assign(Object.assign({},this.data),{label:(r=(i=(n=(t=o===null||o===void 0?void 0:o.results)===null||t===void 0?void 0:t.bindings)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.o)===null||r===void 0?void 0:r.value,loading:false})})).catch((o=>Object.assign(Object.assign({},this.data),{error:true,loading:false})))}render(){return t(n,null,this.data.label,this.data.loading&&`loading...`,this.data.error&&`error!`,!this.data.label&&!this.data.loading&&!this.data.error&&t("span",{class:"no-label-found"},"no label found"),t("slot",null))}};w.style=b;const y='html.ios{--ion-default-font:-apple-system, BlinkMacSystemFont, "Helvetica Neue", "Roboto", sans-serif}html.md{--ion-default-font:"Roboto", "Helvetica Neue", sans-serif}html{--ion-font-family:var(--ion-default-font)}body{background:var(--ion-background-color)}body.backdrop-no-scroll{overflow:hidden}html.ios ion-modal.modal-card ion-header ion-toolbar:first-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:first-of-type,html.ios ion-modal ion-footer ion-toolbar:first-of-type{padding-top:6px}html.ios ion-modal.modal-card ion-header ion-toolbar:last-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:last-of-type{padding-bottom:6px}html.ios ion-modal ion-toolbar{padding-right:calc(var(--ion-safe-area-right) + 8px);padding-left:calc(var(--ion-safe-area-left) + 8px)}@media screen and (min-width: 768px){html.ios ion-modal.modal-card:first-of-type{--backdrop-opacity:0.18}}ion-modal.modal-default.show-modal~ion-modal.modal-default{--backdrop-opacity:0;--box-shadow:none}html.ios ion-modal.modal-card .ion-page{border-top-left-radius:var(--border-radius)}.ion-color-primary{--ion-color-base:var(--ion-color-primary, #3880ff) !important;--ion-color-base-rgb:var(--ion-color-primary-rgb, 56, 128, 255) !important;--ion-color-contrast:var(--ion-color-primary-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-primary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-primary-shade, #3171e0) !important;--ion-color-tint:var(--ion-color-primary-tint, #4c8dff) !important}.ion-color-secondary{--ion-color-base:var(--ion-color-secondary, #3dc2ff) !important;--ion-color-base-rgb:var(--ion-color-secondary-rgb, 61, 194, 255) !important;--ion-color-contrast:var(--ion-color-secondary-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-secondary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-secondary-shade, #36abe0) !important;--ion-color-tint:var(--ion-color-secondary-tint, #50c8ff) !important}.ion-color-tertiary{--ion-color-base:var(--ion-color-tertiary, #5260ff) !important;--ion-color-base-rgb:var(--ion-color-tertiary-rgb, 82, 96, 255) !important;--ion-color-contrast:var(--ion-color-tertiary-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-tertiary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-tertiary-shade, #4854e0) !important;--ion-color-tint:var(--ion-color-tertiary-tint, #6370ff) !important}.ion-color-success{--ion-color-base:var(--ion-color-success, #2dd36f) !important;--ion-color-base-rgb:var(--ion-color-success-rgb, 45, 211, 111) !important;--ion-color-contrast:var(--ion-color-success-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-success-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-success-shade, #28ba62) !important;--ion-color-tint:var(--ion-color-success-tint, #42d77d) !important}.ion-color-warning{--ion-color-base:var(--ion-color-warning, #ffc409) !important;--ion-color-base-rgb:var(--ion-color-warning-rgb, 255, 196, 9) !important;--ion-color-contrast:var(--ion-color-warning-contrast, #000) !important;--ion-color-contrast-rgb:var(--ion-color-warning-contrast-rgb, 0, 0, 0) !important;--ion-color-shade:var(--ion-color-warning-shade, #e0ac08) !important;--ion-color-tint:var(--ion-color-warning-tint, #ffca22) !important}.ion-color-danger{--ion-color-base:var(--ion-color-danger, #eb445a) !important;--ion-color-base-rgb:var(--ion-color-danger-rgb, 235, 68, 90) !important;--ion-color-contrast:var(--ion-color-danger-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-danger-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-danger-shade, #cf3c4f) !important;--ion-color-tint:var(--ion-color-danger-tint, #ed576b) !important}.ion-color-light{--ion-color-base:var(--ion-color-light, #f4f5f8) !important;--ion-color-base-rgb:var(--ion-color-light-rgb, 244, 245, 248) !important;--ion-color-contrast:var(--ion-color-light-contrast, #000) !important;--ion-color-contrast-rgb:var(--ion-color-light-contrast-rgb, 0, 0, 0) !important;--ion-color-shade:var(--ion-color-light-shade, #d7d8da) !important;--ion-color-tint:var(--ion-color-light-tint, #f5f6f9) !important}.ion-color-medium{--ion-color-base:var(--ion-color-medium, #92949c) !important;--ion-color-base-rgb:var(--ion-color-medium-rgb, 146, 148, 156) !important;--ion-color-contrast:var(--ion-color-medium-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-medium-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-medium-shade, #808289) !important;--ion-color-tint:var(--ion-color-medium-tint, #9d9fa6) !important}.ion-color-dark{--ion-color-base:var(--ion-color-dark, #222428) !important;--ion-color-base-rgb:var(--ion-color-dark-rgb, 34, 36, 40) !important;--ion-color-contrast:var(--ion-color-dark-contrast, #fff) !important;--ion-color-contrast-rgb:var(--ion-color-dark-contrast-rgb, 255, 255, 255) !important;--ion-color-shade:var(--ion-color-dark-shade, #1e2023) !important;--ion-color-tint:var(--ion-color-dark-tint, #383a3e) !important}.ion-page{left:0;right:0;top:0;bottom:0;display:flex;position:absolute;flex-direction:column;justify-content:space-between;contain:layout size style;overflow:hidden;z-index:0}ion-modal>.ion-page{position:relative;contain:layout style;height:100%}.split-pane-visible>.ion-page.split-pane-main{position:relative}ion-route,ion-route-redirect,ion-router,ion-select-option,ion-nav-controller,ion-menu-controller,ion-action-sheet-controller,ion-alert-controller,ion-loading-controller,ion-modal-controller,ion-picker-controller,ion-popover-controller,ion-toast-controller,.ion-page-hidden{display:none !important}.ion-page-invisible{opacity:0}.can-go-back>ion-header ion-back-button{display:block}html.plt-ios.plt-hybrid,html.plt-ios.plt-pwa{--ion-statusbar-padding:20px}@supports (padding-top: 20px){html{--ion-safe-area-top:var(--ion-statusbar-padding)}}@supports (padding-top: constant(safe-area-inset-top)){html{--ion-safe-area-top:constant(safe-area-inset-top);--ion-safe-area-bottom:constant(safe-area-inset-bottom);--ion-safe-area-left:constant(safe-area-inset-left);--ion-safe-area-right:constant(safe-area-inset-right)}}@supports (padding-top: env(safe-area-inset-top)){html{--ion-safe-area-top:env(safe-area-inset-top);--ion-safe-area-bottom:env(safe-area-inset-bottom);--ion-safe-area-left:env(safe-area-inset-left);--ion-safe-area-right:env(safe-area-inset-right)}}ion-card.ion-color .ion-inherit-color,ion-card-header.ion-color .ion-inherit-color{color:inherit}.menu-content{transform:translate3d(0,  0,  0)}.menu-content-open{cursor:pointer;touch-action:manipulation;pointer-events:none}.ios .menu-content-reveal{box-shadow:-8px 0 42px rgba(0, 0, 0, 0.08)}[dir=rtl].ios .menu-content-reveal{box-shadow:8px 0 42px rgba(0, 0, 0, 0.08)}.md .menu-content-reveal{box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18)}.md .menu-content-push{box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18)}ion-accordion-group.accordion-group-expand-inset>ion-accordion:first-of-type{border-top-left-radius:8px;border-top-right-radius:8px}ion-accordion-group.accordion-group-expand-inset>ion-accordion:last-of-type{border-bottom-left-radius:8px;border-bottom-right-radius:8px}ion-accordion-group>ion-accordion:last-of-type ion-item[slot=header]{--border-width:0px}ion-accordion.accordion-animated>[slot=header] .ion-accordion-toggle-icon{transition:300ms transform cubic-bezier(0.25, 0.8, 0.5, 1)}@media (prefers-reduced-motion: reduce){ion-accordion .ion-accordion-toggle-icon{transition:none !important}}ion-accordion.accordion-expanding>[slot=header] .ion-accordion-toggle-icon,ion-accordion.accordion-expanded>[slot=header] .ion-accordion-toggle-icon{transform:rotate(180deg)}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-previous ion-item[slot=header]{--border-width:0px;--inner-border-width:0px}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanding:first-of-type,ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanded:first-of-type{margin-top:0}ion-input input::-webkit-date-and-time-value{text-align:start}.ion-datetime-button-overlay{--width:fit-content;--height:fit-content}.ion-datetime-button-overlay ion-datetime.datetime-grid{width:320px;min-height:320px}:host.container,.container{display:block;column-count:var(--column-count);column-gap:var(--column-gap);column-rule-style:var(--column-rule-style);column-rule-width:var(--column-rule-width);column-rule-color:var(--column-rule-color);column-rule:var(--column-rule);column-span:var(--column-span);column-width:var(--column-width)}.predicateContainer{padding:var(--ion-padding)}.predicateContainer~.predicateContainer{margin-top:2rem}';const x=(o,t,n,i)=>{let r;const a=o=>o.split(",").map((o=>`${o.trim()}`));let e="";if(i){const o=a(i);const t=o.map((o=>`"${o}"`));e=`FILTER (str(?predicate) NOT IN (\n      ${t.join(`,\n        `)}\n      ))`}if(n){const i=a(n);const s=i.map((n=>`\n      {\n        SELECT (<${n}> as ?predicate) ?predicateLabel (count(distinct ?object) as ?count)\n        WHERE {\n          <${o}> <${n}> ?object .\n          OPTIONAL {\n            <${n}> rdfs:label ?predicateLabel .\n            FILTER(LANG(?predicateLabel) IN ("${t}", "en"))\n          } .\n          ${e}\n        }\n        GROUP BY ?predicate ?predicateLabel\n      }`));r=`SELECT * {\n      ${s.join("\nUNION\n")}\n    }`}else{r=`\n    SELECT ?predicate ?predicateLabel (count(distinct ?object) as ?count)\n    WHERE {\n      <${o}> ?predicate ?object .\n      OPTIONAL {\n        ?predicate rdfs:label ?predicateLabel .\n        FILTER(LANG(?predicateLabel) IN ("${t}", "en"))\n      } .\n      ${e}\n    }\n    GROUP BY ?predicate ?predicateLabel\n    `}return`\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX owl: <http://www.w3.org/2002/07/owl#>\nPREFIX xml: <http://www.w3.org/XML/1998/namespace>\nPREFIX xsd: <http://www.w3.org/2001/XMLSchema#>\nPREFIX geo: <http://www.opengis.net/ont/geosparql#>\nPREFIX time: <http://www.w3.org/2006/time#>\nPREFIX ontome: <https://ontome.net/ontology/>\nPREFIX geov: <http://geovistory.org/resource/>\n\n${r}\n`};const E=class{constructor(t){o(this,t);this.dataFetched=i(this,"dataFetched",7);this._ssrId=undefined;this.data=undefined;this.sparqlEndpoint=undefined;this.entityUri=undefined;this.language="en";this.fetchBeforeRender=true;this.uriRegex=undefined;this.uriReplace=undefined;this.color="";this.predicateInclude=undefined;this.predicateExclude=undefined;this.fixedGrid=undefined;a(this)}async componentWillLoad(){if(this.fetchBeforeRender){this.data=e(this._ssrId)}if(!this.data){this.data={loading:true};await this.fetchData().then((o=>{var t;o.propsWithCount=this.filterByLanguage((t=o.propsWithCount)!==null&&t!==void 0?t:[],this.language);this.data=o;s(this._ssrId,o);this.dataFetched.emit(o);return o})).catch((o=>{this.data=o;return o}))}}filterByLanguage(o,t){o.map((t=>{o.filter((o=>t.predicate.value==o.predicate.value&&t!=o&&t.predicateLabel["xml:lang"]==o.predicateLabel["xml:lang"])).forEach((o=>{t.predicateLabel.value+=", "+o.predicateLabel.value;o.predicateLabel["xml:lang"]="deactivate"}))}));return o.filter((n=>{if(o.filter((o=>n.predicate.value==o.predicate.value&&n!=o)).length){if(n.predicateLabel["xml:lang"]==t){return true}else{return false}}else{return true}}))}async fetchData(){let o={loading:true};const t=x(this.entityUri,this.language,this.predicateInclude,this.predicateExclude);await r(this.sparqlEndpoint,t).then((t=>{var n;o={loading:false,propsWithCount:(n=t===null||t===void 0?void 0:t.results)===null||n===void 0?void 0:n.bindings}})).catch((t=>{o={loading:false,error:true}}));return o}render(){if(this.fixedGrid){return t(n,null,t("ion-grid",{fixed:true,class:"container"},this.renderCards()))}return t(n,{class:"container"},this.renderCards())}renderCards(){return this.data.propsWithCount.map((o=>{var n;return t("div",{class:"predicateContainer"},t("geov-entity-props-by-predicate",{entityUri:this.entityUri,sparqlEndpoint:this.sparqlEndpoint,totalCount:Number(o.count.value),predicateUri:o.predicate.value,predicateLabel:o.predicateLabel?(n=o.predicateLabel)===null||n===void 0?void 0:n.value:o.predicate.value.replace("http://www.w3.org/2000/01/rdf-schema#","rdfs:").replace("http://www.w3.org/1999/02/22-rdf-syntax-ns#","rdf:"),uriRegex:this.uriRegex,uriReplace:this.uriReplace,color:this.color}))}))}};E.style=y;export{p as geov_entity_class_label,f as geov_entity_definition,g as geov_entity_download_rdf,w as geov_entity_label,E as geov_entity_properties};
//# sourceMappingURL=p-4b36bfff.entry.js.map